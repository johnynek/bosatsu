<!DOCTYPE html>
<html class="no-js" lang="en">

<head>
<title>Compiler Leveraging Type Inhabitedness · Bosatsu Documentation</title>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<meta name="description" content='paradox docs'/>
<link rel="canonical" href="https://github.com/johnynek/bosatsudesign-docs/compiler_leveraging_type_inhabitedness.html"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:100normal,100italic,300normal,300italic,400normal,400italic,500normal,500italic,700normal,700italic,900normal,900italicc" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../lib/jquery/jquery.min.js"></script>
<script type="text/javascript" src="../js/page.js"></script>
<script type="text/javascript" src="../js/warnOldVersion.js"></script>
<script type="text/javascript" src="../js/groups.js"></script>
<script type="text/javascript" src="../js/snippets.js"></script>
<link rel="stylesheet" type="text/css" href="../lib/foundation/dist/foundation.min.css"/>
<link rel="stylesheet" type="text/css" href="../css/page.css"/>

<!--
<link rel="shortcut icon" href="../images/favicon.ico" />
-->
</head>

<body>
<div class="off-canvas-wrapper">
<div class="off-canvas-wrapper-inner" data-off-canvas-wrapper>

<div class="off-canvas position-left" id="off-canvas-menu" data-off-canvas>
<nav class="off-canvas-nav">
<div class="nav-home">
<a href="../index.html" >
<span class="home-icon">⌂</span>Bosatsu Documentation
</a>
<div class="version-number">
0.0.0+1-c3e877aa*
</div>
</div>
<div class="nav-toc">
<ul>
  <li><a href="../design.html" class="page">Bosatsu Design Philosophy and Goals</a></li>
  <li><a href="../design-docs/index.html" class="page">Design Docs</a>
  <ul>
    <li><a href="../design-docs/compiler_leveraging_type_inhabitedness.html" class="active page">Compiler Leveraging Type Inhabitedness</a></li>
    <li><a href="../design-docs/pattern_guards_design.html" class="page">Pattern Guards Design</a></li>
    <li><a href="../design-docs/issue_1628_pattern_value_reuse_design.html" class="page">Issue 1628: Pattern Value Reuse in <code>TypedExprNormalization</code></a></li>
    <li><a href="../design-docs/issue_1676_default_values_struct_enum_design.html" class="page">Issue 1676: Default Values in Struct and Enum Constructors</a></li>
    <li><a href="../design-docs/issue_356_struct_update_syntax_design.html" class="page">Issue 356: Struct Update Syntax (<code>..old</code>)</a></li>
    <li><a href="../design-docs/well_typed_statement_generator_design.html" class="page">Well-Typed Statement Generator Design</a></li>
    <li><a href="../design-docs/quantifier-evidence-design.html" class="page">Quantifier Evidence on <code>TypedExpr.Annotation</code></a></li>
    <li><a href="../design-docs/issue_1718_instantiate_pushdown_unification_plan.html" class="page">Issue 1718: Instantiate/Pushdown Unification Plan</a></li>
    <li><a href="../design-docs/lexicographic_recur_design.html" class="page">Lexicographic <code>recur</code> Tuple Design</a></li>
  </ul></li>
  <li><a href="../getting_started.html" class="page">Getting started (new repo)</a></li>
  <li><a href="../language_guide.html" class="page">Language Guide</a></li>
  <li><a href="../recursion.html" class="page">Recursion in Bosatsu</a></li>
  <li><a href="../generating_json.html" class="page">Generating JSON from Bosatsu Values</a></li>
  <li><a href="../debugging_with_eval.html" class="page">Debugging with <code>lib eval</code></a></li>
  <li><a href="../debugging_with_show.html" class="page">Inspecting Compiled Output with <code>lib show</code></a></li>
  <li><a href="../transpile_python.html" class="page">Compiling to Python</a></li>
  <li><a href="../generated/core_alpha/index.html" class="page">Core Alpha API</a>
  <ul>
    <li><a href="../generated/core_alpha/Ackermann.html" class="page"><code>Ackermann</code></a></li>
    <li><a href="../generated/core_alpha/AvlTree.html" class="page"><code>AvlTree</code></a></li>
    <li><a href="../generated/core_alpha/Bar.html" class="page"><code>Bar</code></a></li>
    <li><a href="../generated/core_alpha/BazelDepsApi.html" class="page"><code>BazelDepsApi</code></a></li>
    <li><a href="../generated/core_alpha/Bo/Test.html" class="page"><code>Bo/Test</code></a></li>
    <li><a href="../generated/core_alpha/Bosatsu/Bool.html" class="page"><code>Bosatsu/Bool</code></a></li>
    <li><a href="../generated/core_alpha/Bosatsu/Char.html" class="page"><code>Bosatsu/Char</code></a></li>
    <li><a href="../generated/core_alpha/Bosatsu/Collection/Array.html" class="page"><code>Bosatsu/Collection/Array</code></a></li>
    <li><a href="../generated/core_alpha/Bosatsu/Collection/Queue.html" class="page"><code>Bosatsu/Collection/Queue</code></a></li>
    <li><a href="../generated/core_alpha/Bosatsu/Collection/TreeList.html" class="page"><code>Bosatsu/Collection/TreeList</code></a></li>
    <li><a href="../generated/core_alpha/Bosatsu/Dict.html" class="page"><code>Bosatsu/Dict</code></a></li>
    <li><a href="../generated/core_alpha/Bosatsu/Example/ApplicativeTraverse.html" class="page"><code>Bosatsu/Example/ApplicativeTraverse</code></a></li>
    <li><a href="../generated/core_alpha/Bosatsu/Example/Json/Github/Workflows/Ci.html" class="page"><code>Bosatsu/Example/Json/Github/Workflows/Ci</code></a></li>
    <li><a href="../generated/core_alpha/Bosatsu/Example/Json/Github/Workflows/CodecovMain.html" class="page"><code>Bosatsu/Example/Json/Github/Workflows/CodecovMain</code></a></li>
    <li><a href="../generated/core_alpha/Bosatsu/Example/Json/Github/Workflows/DeployWeb.html" class="page"><code>Bosatsu/Example/Json/Github/Workflows/DeployWeb</code></a></li>
    <li><a href="../generated/core_alpha/Bosatsu/Example/Json/Github/Workflows/Release.html" class="page"><code>Bosatsu/Example/Json/Github/Workflows/Release</code></a></li>
    <li><a href="../generated/core_alpha/Bosatsu/Example/Json/Github/Workflows/Util.html" class="page"><code>Bosatsu/Example/Json/Github/Workflows/Util</code></a></li>
    <li><a href="../generated/core_alpha/Bosatsu/FibBench.html" class="page"><code>Bosatsu/FibBench</code></a></li>
    <li><a href="../generated/core_alpha/Bosatsu/IO/Error.html" class="page"><code>Bosatsu/IO/Error</code></a></li>
    <li><a href="../generated/core_alpha/Bosatsu/IO/Std.html" class="page"><code>Bosatsu/IO/Std</code></a></li>
    <li><a href="../generated/core_alpha/Bosatsu/Json.html" class="page"><code>Bosatsu/Json</code></a></li>
    <li><a href="../generated/core_alpha/Bosatsu/List.html" class="page"><code>Bosatsu/List</code></a></li>
    <li><a href="../generated/core_alpha/Bosatsu/Nothing.html" class="page"><code>Bosatsu/Nothing</code></a></li>
    <li><a href="../generated/core_alpha/Bosatsu/Num/BinNat.html" class="page"><code>Bosatsu/Num/BinNat</code></a></li>
    <li><a href="../generated/core_alpha/Bosatsu/Num/Binary.html" class="page"><code>Bosatsu/Num/Binary</code></a></li>
    <li><a href="../generated/core_alpha/Bosatsu/Num/Float64.html" class="page"><code>Bosatsu/Num/Float64</code></a></li>
    <li><a href="../generated/core_alpha/Bosatsu/Num/Nat.html" class="page"><code>Bosatsu/Num/Nat</code></a></li>
    <li><a href="../generated/core_alpha/Bosatsu/NumberProps.html" class="page"><code>Bosatsu/NumberProps</code></a></li>
    <li><a href="../generated/core_alpha/Bosatsu/Option.html" class="page"><code>Bosatsu/Option</code></a></li>
    <li><a href="../generated/core_alpha/Bosatsu/Predef.html" class="page"><code>Bosatsu/Predef</code></a></li>
    <li><a href="../generated/core_alpha/Bosatsu/Prog.html" class="page"><code>Bosatsu/Prog</code></a></li>
    <li><a href="../generated/core_alpha/Bosatsu/Rand.html" class="page"><code>Bosatsu/Rand</code></a></li>
    <li><a href="../generated/core_alpha/Bosatsu/Testing/Properties.html" class="page"><code>Bosatsu/Testing/Properties</code></a></li>
    <li><a href="../generated/core_alpha/BuildExample.html" class="page"><code>BuildExample</code></a></li>
    <li><a href="../generated/core_alpha/BuildLibrary.html" class="page"><code>BuildLibrary</code></a></li>
    <li><a href="../generated/core_alpha/DictTools.html" class="page"><code>DictTools</code></a></li>
    <li><a href="../generated/core_alpha/Euler/Four.html" class="page"><code>Euler/Four</code></a></li>
    <li><a href="../generated/core_alpha/Euler/One.html" class="page"><code>Euler/One</code></a></li>
    <li><a href="../generated/core_alpha/Euler/P5.html" class="page"><code>Euler/P5</code></a></li>
    <li><a href="../generated/core_alpha/Euler/P6.html" class="page"><code>Euler/P6</code></a></li>
    <li><a href="../generated/core_alpha/Euler/P7.html" class="page"><code>Euler/P7</code></a></li>
    <li><a href="../generated/core_alpha/Euler/Three.html" class="page"><code>Euler/Three</code></a></li>
    <li><a href="../generated/core_alpha/Euler/Two.html" class="page"><code>Euler/Two</code></a></li>
    <li><a href="../generated/core_alpha/Eval.html" class="page"><code>Eval</code></a></li>
    <li><a href="../generated/core_alpha/Foo.html" class="page"><code>Foo</code></a></li>
    <li><a href="../generated/core_alpha/GenDeps.html" class="page"><code>GenDeps</code></a></li>
    <li><a href="../generated/core_alpha/IntTest.html" class="page"><code>IntTest</code></a></li>
    <li><a href="../generated/core_alpha/Issue1633.html" class="page"><code>Issue1633</code></a></li>
    <li><a href="../generated/core_alpha/ListPat.html" class="page"><code>ListPat</code></a></li>
    <li><a href="../generated/core_alpha/Parser.html" class="page"><code>Parser</code></a></li>
    <li><a href="../generated/core_alpha/PatternExamples.html" class="page"><code>PatternExamples</code></a></li>
    <li><a href="../generated/core_alpha/PredefTests.html" class="page"><code>PredefTests</code></a></li>
    <li><a href="../generated/core_alpha/Quicksort.html" class="page"><code>Quicksort</code></a></li>
    <li><a href="../generated/core_alpha/RecordSet/Library.html" class="page"><code>RecordSet/Library</code></a></li>
    <li><a href="../generated/core_alpha/StrConcatExample.html" class="page"><code>StrConcatExample</code></a></li>
    <li><a href="../generated/core_alpha/StringPatternBranchTests.html" class="page"><code>StringPatternBranchTests</code></a></li>
    <li><a href="../generated/core_alpha/TypeConstraint.html" class="page"><code>TypeConstraint</code></a></li>
  </ul></li>
</ul>
</div>

</nav>
</div>

<div class="off-canvas-content" data-off-canvas-content>

<header class="site-header expanded row">
<div class="small-12 column">
<a href="#" class="off-canvas-toggle hide-for-medium" data-toggle="off-canvas-menu"><svg class="svg-icon svg-icon-menu" version="1.1" id="Menu" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 20 20" enable-background="new 0 0 20 20" xml:space="preserve"> <path class="svg-icon-menu-path" fill="#53CDEC" d="M16.4,9H3.6C3.048,9,3,9.447,3,10c0,0.553,0.048,1,0.6,1H16.4c0.552,0,0.6-0.447,0.6-1C17,9.447,16.952,9,16.4,9z M16.4,13
H3.6C3.048,13,3,13.447,3,14c0,0.553,0.048,1,0.6,1H16.4c0.552,0,0.6-0.447,0.6-1C17,13.447,16.952,13,16.4,13z M3.6,7H16.4
C16.952,7,17,6.553,17,6c0-0.553-0.048-1-0.6-1H3.6C3.048,5,3,5.447,3,6C3,6.553,3.048,7,3.6,7z"/></svg>
</a>
<div class="title"><a href="../index.html">Bosatsu Documentation</a></div>

<!--
<a href="https://www.example.com" class="logo show-for-medium">logo</a>
-->
</div>
</header>

<div class="expanded row">

<div class="medium-3 large-2 show-for-medium column">
<nav class="site-nav">
<div class="nav-home">
<a href="../index.html" >
<span class="home-icon">⌂</span>Bosatsu Documentation
</a>
<div class="version-number">
0.0.0+1-c3e877aa*
</div>
</div>
<div class="nav-toc">
<ul>
  <li><a href="../design.html" class="page">Bosatsu Design Philosophy and Goals</a></li>
  <li><a href="../design-docs/index.html" class="page">Design Docs</a>
  <ul>
    <li><a href="../design-docs/compiler_leveraging_type_inhabitedness.html" class="active page">Compiler Leveraging Type Inhabitedness</a></li>
    <li><a href="../design-docs/pattern_guards_design.html" class="page">Pattern Guards Design</a></li>
    <li><a href="../design-docs/issue_1628_pattern_value_reuse_design.html" class="page">Issue 1628: Pattern Value Reuse in <code>TypedExprNormalization</code></a></li>
    <li><a href="../design-docs/issue_1676_default_values_struct_enum_design.html" class="page">Issue 1676: Default Values in Struct and Enum Constructors</a></li>
    <li><a href="../design-docs/issue_356_struct_update_syntax_design.html" class="page">Issue 356: Struct Update Syntax (<code>..old</code>)</a></li>
    <li><a href="../design-docs/well_typed_statement_generator_design.html" class="page">Well-Typed Statement Generator Design</a></li>
    <li><a href="../design-docs/quantifier-evidence-design.html" class="page">Quantifier Evidence on <code>TypedExpr.Annotation</code></a></li>
    <li><a href="../design-docs/issue_1718_instantiate_pushdown_unification_plan.html" class="page">Issue 1718: Instantiate/Pushdown Unification Plan</a></li>
    <li><a href="../design-docs/lexicographic_recur_design.html" class="page">Lexicographic <code>recur</code> Tuple Design</a></li>
  </ul></li>
  <li><a href="../getting_started.html" class="page">Getting started (new repo)</a></li>
  <li><a href="../language_guide.html" class="page">Language Guide</a></li>
  <li><a href="../recursion.html" class="page">Recursion in Bosatsu</a></li>
  <li><a href="../generating_json.html" class="page">Generating JSON from Bosatsu Values</a></li>
  <li><a href="../debugging_with_eval.html" class="page">Debugging with <code>lib eval</code></a></li>
  <li><a href="../debugging_with_show.html" class="page">Inspecting Compiled Output with <code>lib show</code></a></li>
  <li><a href="../transpile_python.html" class="page">Compiling to Python</a></li>
  <li><a href="../generated/core_alpha/index.html" class="page">Core Alpha API</a>
  <ul>
    <li><a href="../generated/core_alpha/Ackermann.html" class="page"><code>Ackermann</code></a></li>
    <li><a href="../generated/core_alpha/AvlTree.html" class="page"><code>AvlTree</code></a></li>
    <li><a href="../generated/core_alpha/Bar.html" class="page"><code>Bar</code></a></li>
    <li><a href="../generated/core_alpha/BazelDepsApi.html" class="page"><code>BazelDepsApi</code></a></li>
    <li><a href="../generated/core_alpha/Bo/Test.html" class="page"><code>Bo/Test</code></a></li>
    <li><a href="../generated/core_alpha/Bosatsu/Bool.html" class="page"><code>Bosatsu/Bool</code></a></li>
    <li><a href="../generated/core_alpha/Bosatsu/Char.html" class="page"><code>Bosatsu/Char</code></a></li>
    <li><a href="../generated/core_alpha/Bosatsu/Collection/Array.html" class="page"><code>Bosatsu/Collection/Array</code></a></li>
    <li><a href="../generated/core_alpha/Bosatsu/Collection/Queue.html" class="page"><code>Bosatsu/Collection/Queue</code></a></li>
    <li><a href="../generated/core_alpha/Bosatsu/Collection/TreeList.html" class="page"><code>Bosatsu/Collection/TreeList</code></a></li>
    <li><a href="../generated/core_alpha/Bosatsu/Dict.html" class="page"><code>Bosatsu/Dict</code></a></li>
    <li><a href="../generated/core_alpha/Bosatsu/Example/ApplicativeTraverse.html" class="page"><code>Bosatsu/Example/ApplicativeTraverse</code></a></li>
    <li><a href="../generated/core_alpha/Bosatsu/Example/Json/Github/Workflows/Ci.html" class="page"><code>Bosatsu/Example/Json/Github/Workflows/Ci</code></a></li>
    <li><a href="../generated/core_alpha/Bosatsu/Example/Json/Github/Workflows/CodecovMain.html" class="page"><code>Bosatsu/Example/Json/Github/Workflows/CodecovMain</code></a></li>
    <li><a href="../generated/core_alpha/Bosatsu/Example/Json/Github/Workflows/DeployWeb.html" class="page"><code>Bosatsu/Example/Json/Github/Workflows/DeployWeb</code></a></li>
    <li><a href="../generated/core_alpha/Bosatsu/Example/Json/Github/Workflows/Release.html" class="page"><code>Bosatsu/Example/Json/Github/Workflows/Release</code></a></li>
    <li><a href="../generated/core_alpha/Bosatsu/Example/Json/Github/Workflows/Util.html" class="page"><code>Bosatsu/Example/Json/Github/Workflows/Util</code></a></li>
    <li><a href="../generated/core_alpha/Bosatsu/FibBench.html" class="page"><code>Bosatsu/FibBench</code></a></li>
    <li><a href="../generated/core_alpha/Bosatsu/IO/Error.html" class="page"><code>Bosatsu/IO/Error</code></a></li>
    <li><a href="../generated/core_alpha/Bosatsu/IO/Std.html" class="page"><code>Bosatsu/IO/Std</code></a></li>
    <li><a href="../generated/core_alpha/Bosatsu/Json.html" class="page"><code>Bosatsu/Json</code></a></li>
    <li><a href="../generated/core_alpha/Bosatsu/List.html" class="page"><code>Bosatsu/List</code></a></li>
    <li><a href="../generated/core_alpha/Bosatsu/Nothing.html" class="page"><code>Bosatsu/Nothing</code></a></li>
    <li><a href="../generated/core_alpha/Bosatsu/Num/BinNat.html" class="page"><code>Bosatsu/Num/BinNat</code></a></li>
    <li><a href="../generated/core_alpha/Bosatsu/Num/Binary.html" class="page"><code>Bosatsu/Num/Binary</code></a></li>
    <li><a href="../generated/core_alpha/Bosatsu/Num/Float64.html" class="page"><code>Bosatsu/Num/Float64</code></a></li>
    <li><a href="../generated/core_alpha/Bosatsu/Num/Nat.html" class="page"><code>Bosatsu/Num/Nat</code></a></li>
    <li><a href="../generated/core_alpha/Bosatsu/NumberProps.html" class="page"><code>Bosatsu/NumberProps</code></a></li>
    <li><a href="../generated/core_alpha/Bosatsu/Option.html" class="page"><code>Bosatsu/Option</code></a></li>
    <li><a href="../generated/core_alpha/Bosatsu/Predef.html" class="page"><code>Bosatsu/Predef</code></a></li>
    <li><a href="../generated/core_alpha/Bosatsu/Prog.html" class="page"><code>Bosatsu/Prog</code></a></li>
    <li><a href="../generated/core_alpha/Bosatsu/Rand.html" class="page"><code>Bosatsu/Rand</code></a></li>
    <li><a href="../generated/core_alpha/Bosatsu/Testing/Properties.html" class="page"><code>Bosatsu/Testing/Properties</code></a></li>
    <li><a href="../generated/core_alpha/BuildExample.html" class="page"><code>BuildExample</code></a></li>
    <li><a href="../generated/core_alpha/BuildLibrary.html" class="page"><code>BuildLibrary</code></a></li>
    <li><a href="../generated/core_alpha/DictTools.html" class="page"><code>DictTools</code></a></li>
    <li><a href="../generated/core_alpha/Euler/Four.html" class="page"><code>Euler/Four</code></a></li>
    <li><a href="../generated/core_alpha/Euler/One.html" class="page"><code>Euler/One</code></a></li>
    <li><a href="../generated/core_alpha/Euler/P5.html" class="page"><code>Euler/P5</code></a></li>
    <li><a href="../generated/core_alpha/Euler/P6.html" class="page"><code>Euler/P6</code></a></li>
    <li><a href="../generated/core_alpha/Euler/P7.html" class="page"><code>Euler/P7</code></a></li>
    <li><a href="../generated/core_alpha/Euler/Three.html" class="page"><code>Euler/Three</code></a></li>
    <li><a href="../generated/core_alpha/Euler/Two.html" class="page"><code>Euler/Two</code></a></li>
    <li><a href="../generated/core_alpha/Eval.html" class="page"><code>Eval</code></a></li>
    <li><a href="../generated/core_alpha/Foo.html" class="page"><code>Foo</code></a></li>
    <li><a href="../generated/core_alpha/GenDeps.html" class="page"><code>GenDeps</code></a></li>
    <li><a href="../generated/core_alpha/IntTest.html" class="page"><code>IntTest</code></a></li>
    <li><a href="../generated/core_alpha/Issue1633.html" class="page"><code>Issue1633</code></a></li>
    <li><a href="../generated/core_alpha/ListPat.html" class="page"><code>ListPat</code></a></li>
    <li><a href="../generated/core_alpha/Parser.html" class="page"><code>Parser</code></a></li>
    <li><a href="../generated/core_alpha/PatternExamples.html" class="page"><code>PatternExamples</code></a></li>
    <li><a href="../generated/core_alpha/PredefTests.html" class="page"><code>PredefTests</code></a></li>
    <li><a href="../generated/core_alpha/Quicksort.html" class="page"><code>Quicksort</code></a></li>
    <li><a href="../generated/core_alpha/RecordSet/Library.html" class="page"><code>RecordSet/Library</code></a></li>
    <li><a href="../generated/core_alpha/StrConcatExample.html" class="page"><code>StrConcatExample</code></a></li>
    <li><a href="../generated/core_alpha/StringPatternBranchTests.html" class="page"><code>StringPatternBranchTests</code></a></li>
    <li><a href="../generated/core_alpha/TypeConstraint.html" class="page"><code>TypeConstraint</code></a></li>
  </ul></li>
</ul>
</div>

</nav>
</div>

<div class="small-12 medium-9 large-10 column">
<section class="site-content">

<span id="version-warning"></span>

<div class="page-header row">
<div class="medium-12 show-for-medium column">
<div class="nav-breadcrumbs">
<ul>
  <li><a href="../index.html">Bosatsu Documentation</a></li>
  <li><a href="../design-docs/index.html">Design Docs</a></li>
  <li>Compiler Leveraging Type Inhabitedness</li>
</ul>
</div>
</div>
</div>

<div class="page-content row">
<div class="small-12 large-9 column" id="docs">
<h1><a href="#compiler-leveraging-type-inhabitedness" name="compiler-leveraging-type-inhabitedness" class="anchor"><span class="anchor-link"></span></a>Compiler Leveraging Type Inhabitedness</h1>
<p>Status: proposed<br/>Date: 2026-02-19 Issue: <a href="https://github.com/johnynek/bosatsu/issues/1724">https://github.com/johnynek/bosatsu/issues/1724</a></p>
<h2><a href="#goal" name="goal" class="anchor"><span class="anchor-link"></span></a>Goal</h2>
<p>Use type inhabitedness in the compiler to: 1. identify uninhabited types with explicit, complete rules (in a supported fragment), 2. improve match totality by excluding impossible constructors, 3. let users omit uninhabited branch cases, 4. prune unreachable branches before codegen.</p>
<h2><a href="#motivation" name="motivation" class="anchor"><span class="anchor-link"></span></a>Motivation</h2>
<p>We already rely on totality and strong typing, but we do not currently leverage full type inhabitedness information during match checking.</p>
<p>Examples we want to classify statically: 1. <code>forall a. a</code> is uninhabited. 2. <code>struct Nothing(never: Nothing)</code> is uninhabited. 3. A struct with at least one uninhabited field is uninhabited. 4. An enum where every constructor is uninhabited is uninhabited. 5. A function type returning an uninhabited type is uninhabited when all its arguments are inhabited.</p>
<h2><a href="#current-state" name="current-state" class="anchor"><span class="anchor-link"></span></a>Current State</h2>
<p><code>Package.inferBodyUnopt</code> runs <code>TotalityCheck</code> on untyped <code>Expr</code> before rank-n inference.<br/>This cannot use final instantiated scrutinee types (for example <code>Option[NothingLike]</code>) to remove impossible constructors during coverage.</p>
<h2><a href="#scope-and-completeness" name="scope-and-completeness" class="anchor"><span class="anchor-link"></span></a>Scope and Completeness</h2>
<p>Full inhabitation for unrestricted higher-rank/higher-kinded polymorphism is not a practical target here.<br/>This design defines a <strong>complete decision procedure for a supported fragment</strong> and a conservative fallback outside it.</p>
<p>Supported complete fragment: 1. kind-<code>Type</code> (value) types, 2. closed or locally-quantified types built from:  1. ADTs from <code>TypeEnv</code>,  2. function types,  3. <code>forall</code> / <code>exists</code> over kind-<code>Type</code> variables.</p>
<p>Outside the fragment (for example higher-kinded quantifier-heavy cases), analysis returns <code>Unknown</code> and totality behavior remains conservative (no new pruning).</p>
<h2><a href="#formal-rules" name="formal-rules" class="anchor"><span class="anchor-link"></span></a>Formal Rules</h2>
<p>Let <code>I(t)</code> mean “type <code>t</code> is inhabited”, <code>U(t)</code> mean “type <code>t</code> is uninhabited”.</p>
<h3><a href="#base-and-constructors" name="base-and-constructors" class="anchor"><span class="anchor-link"></span></a>Base and constructors</h3>
<ol>
  <li>Base literal types (<code>Int</code>, <code>String</code>, <code>Char</code>, <code>Float64</code>, <code>Bool</code>, <code>Unit</code>) are inhabited.</li>
  <li>For constructor <code>C : τ1, ..., τn -&gt; T</code>:</li>
  <li><code>I(C)</code> iff <code>I(τ1) &amp;&amp; ... &amp;&amp; I(τn)</code>.</li>
  <li>For struct type <code>T</code> (single constructor):</li>
  <li><code>U(T)</code> iff at least one field type is uninhabited.</li>
  <li>For enum type <code>T</code>:</li>
  <li><code>U(T)</code> iff every constructor is uninhabited.</li>
</ol>
<h3><a href="#functions" name="functions" class="anchor"><span class="anchor-link"></span></a>Functions</h3>
<p>For <code>Fn(τ1, ..., τn) -&gt; ρ</code>: 1. <code>U(Fn(...)-&gt;ρ)</code> iff <code>U(ρ)</code> and all arguments are inhabited. 2. Equivalent inhabited form:  1. <code>I(Fn(...)-&gt;ρ)</code> iff <code>I(ρ)</code> or at least one argument is uninhabited.</p>
<p>This captures the requested rule: 1. returning uninhabited type + all args inhabited =&gt; uninhabited, 2. returning uninhabited type + some arg uninhabited =&gt; inhabited (vacuous function).</p>
<h3><a href="#quantifiers" name="quantifiers" class="anchor"><span class="anchor-link"></span></a>Quantifiers</h3>
<p>For kind-<code>Type</code> quantifiers: 1. <code>I(forall a. t)</code> iff <code>for all assignments of a, I(t)</code>. 2. <code>U(forall a. t)</code> iff <code>there exists an assignment of a with U(t)</code>. 3. <code>I(exists a. t)</code> iff <code>there exists an assignment of a with I(t)</code>. 4. <code>U(exists a. t)</code> iff <code>for all assignments of a, U(t)</code>.</p>
<p>This yields: 1. <code>U(forall a. a)</code> (pick an uninhabited assignment), 2. <code>I(forall a. a -&gt; a)</code> (identity), 3. <code>I(forall a. List[a])</code> (empty list constructor), 4. <code>U(forall a. (a, a))</code> if tuple construction requires <code>I(a)</code>.</p>
<h3><a href="#recursive-adts" name="recursive-adts" class="anchor"><span class="anchor-link"></span></a>Recursive ADTs</h3>
<p>For mutually recursive type constants, define equations:</p>
<p><code>I(T(args)) = OR over constructors c of T: (exists c-existentials. AND over c-fields fi: I(fi))</code></p>
<p>Solve as least fixed point over the finite equation graph for the query.<br/>Least fixed point gives expected inductive behavior: 1. <code>struct Nothing(never: Nothing)</code> =&gt; uninhabited, 2. recursion only through impossible constructor paths stays uninhabited.</p>
<h2><a href="#algorithm-design" name="algorithm-design" class="anchor"><span class="anchor-link"></span></a>Algorithm Design</h2>
<p>New module: <code>core/src/main/scala/dev/bosatsu/Inhabitedness.scala</code></p>
<p>Core API: 1. <code>verdict(t: Type, env: TypeEnv[Kind.Arg]): Inhabitedness.Verdict</code> 2. <code>constructorReachable(scrutinee: Type, cons: (PackageName, Constructor), env): Reachability</code></p>
<p>Proposed result types: 1. <code>Inhabited</code> 2. <code>Uninhabited</code> 3. <code>Unknown</code> (outside supported complete fragment)</p>
<p>Implementation strategy: 1. Normalize type (<code>Type.normalize</code>), split quantifiers, and classify by shape. 2. Build/evaluate equations with memoization by <code>(Type, quantifier context)</code>. 3. Use finite quantifier elimination for kind-<code>Type</code> vars (boolean inhabited/uninhabited assignments). 4. Solve recursive SCCs with fixed-point iteration. 5. If unsupported kind-level features are encountered, return <code>Unknown</code>.</p>
<h2><a href="#using-inhabitedness-in-matches" name="using-inhabitedness-in-matches" class="anchor"><span class="anchor-link"></span></a>Using Inhabitedness in Matches</h2>
<p>Introduce typed totality checking that uses scrutinee type + constructor reachability.</p>
<h3><a href="#coverage-domain" name="coverage-domain" class="anchor"><span class="anchor-link"></span></a>Coverage domain</h3>
<p>For match scrutinee type <code>S</code>, define: 1. <code>reachableConstructors(S)</code> = constructors of <code>S</code> whose argument bundle is inhabited under current type instantiation. 2. Coverage requires only these constructors. 3. Constructors proven uninhabited are removed from missing-branch requirements.</p>
<h3><a href="#effects" name="effects" class="anchor"><span class="anchor-link"></span></a>Effects</h3>
<ol>
  <li>Users may omit branches for uninhabited constructors.</li>
  <li>Branches that explicitly match uninhabited constructors are reported as unreachable.</li>
  <li>Pattern-set operations still work, but domain expansion (<code>topFor</code>) filters out unreachable constructors.</li>
</ol>
<h2><a href="#pipeline-changes" name="pipeline-changes" class="anchor"><span class="anchor-link"></span></a>Pipeline Changes</h2>
<p>Current: 1. <code>SourceConverter</code> -&gt; <code>TotalityCheck</code> on <code>Expr</code> -&gt; <code>Infer</code> -&gt; <code>TypedExprNormalization</code></p>
<p>Proposed: 1. <code>SourceConverter</code> -&gt; <code>Infer</code> -&gt; <code>TypedTotalityCheck</code> (inhabitedness-aware) -&gt; <code>TypedExprNormalization</code></p>
<p>Details: 1. Keep cheap source-level pattern-shape validation where helpful. 2. Move exhaustiveness/unreachable match checks to typed AST. 3. <code>Package.inferBodyUnopt</code> should run typed totality after successful inference. 4. Diagnostics stay at source regions via typed tags already attached to <code>TypedExpr</code>.</p>
<h2><a href="#match-pruning-and-codegen" name="match-pruning-and-codegen" class="anchor"><span class="anchor-link"></span></a>Match Pruning and Codegen</h2>
<p>Branch pruning should run after typed totality (or as part of normalization): 1. Remove branches that are impossible from inhabitedness facts. 2. Keep source order of remaining branches. 3. Preserve guard semantics (guarded branches still do not count toward totality unless unguarded fallback exists).</p>
<p>Codegen benefits: 1. smaller match matrices, 2. fewer runtime constructor checks, 3. fewer dead branches emitted in Matchless IR.</p>
<h2><a href="#edge-cases" name="edge-cases" class="anchor"><span class="anchor-link"></span></a>Edge Cases</h2>
<ol>
  <li>Polymorphic matches with free kind-<code>Type</code> vars:</li>
  <li>prune only when constructor is unreachable for all assignments.</li>
  <li>Outside supported fragment:</li>
  <li><code>Unknown</code> means no pruning and existing conservative totality behavior.</li>
  <li>If a scrutinee type itself is uninhabited:</li>
  <li>every branch is unreachable,</li>
  <li>totality is vacuously satisfied.</li>
  <li>Optional future extension: allow empty <code>match</code> syntax explicitly.</li>
</ol>
<h2><a href="#test-plan" name="test-plan" class="anchor"><span class="anchor-link"></span></a>Test Plan</h2>
<p>Add tests across <code>TotalityCheck</code> replacement + inference + normalization: 1. <code>forall a. a</code> classified uninhabited. 2. Recursive self-field struct classified uninhabited. 3. Struct with one uninhabited field classified uninhabited. 4. Enum with one inhabited and one uninhabited constructor:  1. missing inhabited constructor still errors,  2. missing uninhabited constructor does not error. 5. Explicit branch on uninhabited constructor is unreachable. 6. Function rule:  1. <code>Unit -&gt; Nothing</code> uninhabited,  2. <code>Nothing -&gt; Nothing</code> inhabited. 7. Guard interactions:  1. guarded branch still excluded from totality coverage as today. 8. Regression tests for existing match behavior when no inhabitedness facts apply.</p>
<h2><a href="#rollout-plan" name="rollout-plan" class="anchor"><span class="anchor-link"></span></a>Rollout Plan</h2>
<ol>
  <li>Phase 1: add <code>Inhabitedness</code> module + unit tests.</li>
  <li>Phase 2: add typed totality checker and wire into <code>Package.inferBodyUnopt</code>.</li>
  <li>Phase 3: apply branch pruning in normalization/Matchless lowering.</li>
  <li>Phase 4 (optional): syntax/AST support for empty matches on provably uninhabited scrutinees.</li>
</ol>
<h2><a href="#trade-offs" name="trade-offs" class="anchor"><span class="anchor-link"></span></a>Trade-offs</h2>
<p>Pros: 1. Better exhaustiveness precision. 2. Cleaner user code (no mandatory impossible cases). 3. Better generated code via dead-branch pruning.</p>
<p>Costs: 1. More compiler complexity (new analysis + typed totality phase). 2. Some cases remain conservative (<code>Unknown</code>) by design. 3. Totality diagnostics now depend on successful type inference.</p>
<div class="source-github">
The source code for this page can be found <a href="https://github.com/johnynek/bosatsu/tree/master/docs/src/main/paradox/design-docs/compiler_leveraging_type_inhabitedness.md">here</a>.
</div>

<div class="nav-next">
<p><strong>Next:</strong> <a href="../design-docs/pattern_guards_design.html">Pattern Guards Design</a></p>
</div>
</div>
<div class="large-3 show-for-large column" data-sticky-container>
<nav class="sidebar sticky" data-sticky data-anchor="docs" data-sticky-on="large">
<div class="page-nav">
<div class="nav-title">On this page:</div>
<div class="nav-toc">
<ul>
  <li><a href="../design-docs/compiler_leveraging_type_inhabitedness.html#compiler-leveraging-type-inhabitedness" class="header">Compiler Leveraging Type Inhabitedness</a>
  <ul>
    <li><a href="../design-docs/compiler_leveraging_type_inhabitedness.html#goal" class="header">Goal</a></li>
    <li><a href="../design-docs/compiler_leveraging_type_inhabitedness.html#motivation" class="header">Motivation</a></li>
    <li><a href="../design-docs/compiler_leveraging_type_inhabitedness.html#current-state" class="header">Current State</a></li>
    <li><a href="../design-docs/compiler_leveraging_type_inhabitedness.html#scope-and-completeness" class="header">Scope and Completeness</a></li>
    <li><a href="../design-docs/compiler_leveraging_type_inhabitedness.html#formal-rules" class="header">Formal Rules</a></li>
    <li><a href="../design-docs/compiler_leveraging_type_inhabitedness.html#algorithm-design" class="header">Algorithm Design</a></li>
    <li><a href="../design-docs/compiler_leveraging_type_inhabitedness.html#using-inhabitedness-in-matches" class="header">Using Inhabitedness in Matches</a></li>
    <li><a href="../design-docs/compiler_leveraging_type_inhabitedness.html#pipeline-changes" class="header">Pipeline Changes</a></li>
    <li><a href="../design-docs/compiler_leveraging_type_inhabitedness.html#match-pruning-and-codegen" class="header">Match Pruning and Codegen</a></li>
    <li><a href="../design-docs/compiler_leveraging_type_inhabitedness.html#edge-cases" class="header">Edge Cases</a></li>
    <li><a href="../design-docs/compiler_leveraging_type_inhabitedness.html#test-plan" class="header">Test Plan</a></li>
    <li><a href="../design-docs/compiler_leveraging_type_inhabitedness.html#rollout-plan" class="header">Rollout Plan</a></li>
    <li><a href="../design-docs/compiler_leveraging_type_inhabitedness.html#trade-offs" class="header">Trade-offs</a></li>
  </ul></li>
</ul>
</div>
</div>
</nav>
</div>
</div>

</section>
</div>

</div>

<footer class="site-footer">

<section class="site-footer-nav">
<div class="expanded row">
<div class="small-12 large-offset-2 large-10 column">
<div class="row site-footer-content">

<div class="small-12 medium-4 large-3 text-center column">
<div class="nav-links">
<ul>
<!-- <li><a href="https://www.example.com/products/">Products</a> -->
</ul>
</div>
</div>

</div>
</div>
</div>
</section>

<section class="site-footer-base">
<div class="expanded row">
<div class="small-12 large-offset-2 large-10 column">
<div class="row site-footer-content">

<div class="small-12 text-center large-9 column">

<!--
<div class="copyright">
<span class="text">&copy; 2026</span>
<a href="https://www.example.com" class="logo">logo</a>
</div>
-->
</div>

</div>
</div>
</div>
</section>
</footer>

</div>
</div>
</div>
</body>

<script type="text/javascript" src="../lib/foundation/dist/foundation.min.js"></script>
<script type="text/javascript">jQuery(document).foundation();</script>
<script type="text/javascript" src="../js/magellan.js"></script>

<style type="text/css">@import "../lib/prettify/prettify.css";</style>
<script type="text/javascript" src="../lib/prettify/prettify.js"></script>
<script type="text/javascript" src="../lib/prettify/lang-scala.js"></script>
<script type="text/javascript">jQuery(function(){window.prettyPrint && prettyPrint()});</script>
<script type="text/javascript">jQuery(function(jq){initOldVersionWarnings(jq, '0.0.0+1-c3e877aa-SNAPSHOT', 'https://github.com/johnynek/bosatsu')});</script>


</html>
